<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–æ–Ω—è—á–Ω–æ—ó –µ–Ω–µ—Ä–≥—ñ—ó üåû</title>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: 'Manrope', sans-serif; }
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 50; }
    .modal-content { animation: slideIn 0.3s ease-out; }
    @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    button:hover { transform: scale(1.05); transition: transform 0.2s; }
    #pieChart { width: 200px !important; height: 200px !important; margin: 0 auto; }
  </style>
</head>
<body class="bg-gradient-to-b from-blue-100 to-green-100 min-h-screen">
  <div class="container mx-auto p-6 max-w-6xl">
    <h1 class="text-3xl md:text-4xl font-bold text-center text-blue-700 mb-8 flex items-center justify-center">
      <span class="mr-2">üåû</span> –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–æ–Ω—è—á–Ω–æ—ó –µ–Ω–µ—Ä–≥—ñ—ó
    </h1>

    <!-- Main Form -->
    <form id="solarForm" class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8" novalidate>
      <!-- Parameters -->
      <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-gray-100">
        <h2 class="text-xl md:text-2xl font-semibold text-gray-800 mb-6 text-center">–û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ üåû</h2>
        <div class="space-y-5">
          <div>
            <label class="block text-sm font-medium text-gray-700">–¢–∏–ø –æ–±‚Äô—î–∫—Ç–∞</label>
            <select name="entry.1829919613" id="objectType" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white" required>
              <option value="" disabled selected>–í–∏–±–µ—Ä—ñ—Ç—å —Ç–∏–ø</option>
              <option value="–ü—Ä–∏–≤–∞—Ç–Ω–∏–π">–ü—Ä–∏–≤–∞—Ç–Ω–∏–π</option>
              <option value="–ë—ñ–∑–Ω–µ—Å">–ë—ñ–∑–Ω–µ—Å</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–¢–∏–ø —Å—Ç–∞–Ω—Ü—ñ—ó</label>
            <select name="entry.1944894407" id="stationType" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white" required>
              <option value="" disabled selected>–í–∏–±–µ—Ä—ñ—Ç—å —Ç–∏–ø</option>
              <option value="–ú–µ—Ä–µ–∂–µ–≤–∞">–ú–µ—Ä–µ–∂–µ–≤–∞</option>
              <option value="–ì—ñ–±—Ä–∏–¥–Ω–∞">–ì—ñ–±—Ä–∏–¥–Ω–∞</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–†–µ–≥—ñ–æ–Ω</label>
            <input type="text" name="entry.1121418168" id="region" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="–ù–∞–ø—Ä., –ö–∏—ó–≤" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–ë–∞–∂–∞–Ω–∞ –ø–æ—Ç—É–∂–Ω—ñ—Å—Ç—å (–∫–í—Ç)</label>
            <input type="number" name="entry.1606862016" id="powerCapacity" min="0" step="0.1" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="–ù–∞–ø—Ä., 10" required>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–ó–µ–ª–µ–Ω–∏–π —Ç–∞—Ä–∏—Ñ</label>
            <select name="entry.92562261" id="greenTariff" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white" required>
              <option value="" disabled selected>–í–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é</option>
              <option value="–¢–∞–∫">–¢–∞–∫</option>
              <option value="–ù—ñ">–ù—ñ</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Monthly Consumption -->
      <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-gray-100">
        <h2 class="text-xl md:text-2xl font-semibold text-gray-800 mb-6 text-center">–ü–æ–º—ñ—Å—è—á–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è (–∫–í—Ç¬∑–≥–æ–¥) üìä</h2>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">–°—ñ—á–µ–Ω—å</label>
            <input type="number" name="entry.1033290843" id="month1" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–õ–∏–ø–µ–Ω—å</label>
            <input type="number" name="entry.1903782856" id="month7" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–õ—é—Ç–∏–π</label>
            <input type="number" name="entry.1549952799" id="month2" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–°–µ—Ä–ø–µ–Ω—å</label>
            <input type="number" name="entry.793389669" id="month8" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–ë–µ—Ä–µ–∑–µ–Ω—å</label>
            <input type="number" name="entry.390156925" id="month3" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–í–µ—Ä–µ—Å–µ–Ω—å</label>
            <input type="number" name="entry.530840690" id="month9" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–ö–≤—ñ—Ç–µ–Ω—å</label>
            <input type="number" name="entry.2077577077" id="month4" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–ñ–æ–≤—Ç–µ–Ω—å</label>
            <input type="number" name="entry.76616870" id="month10" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–¢—Ä–∞–≤–µ–Ω—å</label>
            <input type="number" name="entry.906592707" id="month5" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–õ–∏—Å—Ç–æ–ø–∞–¥</label>
            <input type="number" name="entry.462924891" id="month11" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–ß–µ—Ä–≤–µ–Ω—å</label>
            <input type="number" name="entry.1387023304" id="month6" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">–ì—Ä—É–¥–µ–Ω—å</label>
            <input type="number" name="entry.2129476631" id="month12" min="0" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="0">
          </div>
        </div>
      </div>

      <!-- Button -->
      <button type="button" id="openContact" class="col-span-2 mt-6 w-full bg-blue-500 text-white p-4 rounded-lg hover:bg-blue-600 transition-colors text-lg font-semibold flex items-center justify-center">
        –†–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ <span class="ml-2">üåû</span>
      </button>
    </form>

    <!-- Results Section -->
    <div id="results" class="bg-white p-6 md:p-8 rounded-xl shadow-lg border border-gray-100 mb-8 fade-in hidden">
      <h2 class="text-xl md:text-2xl font-semibold text-gray-800 mb-6 text-center">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤ üìä</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
        <div class="bg-blue-50 p-4 rounded-lg text-center">
          <p class="text-sm font-medium text-gray-700">–†—ñ—á–Ω–∏–π –≤–∏—Ä–æ–±—ñ—Ç–æ–∫ (–∫–í—Ç¬∑–≥–æ–¥)</p>
          <p id="annualGeneration" class="text-xl font-bold text-blue-600">--</p>
        </div>
        <div class="bg-green-50 p-4 rounded-lg text-center">
          <p class="text-sm font-medium text-gray-700">–ï–∫–æ–Ω–æ–º—ñ—è (–≥—Ä–Ω)</p>
          <p id="savings" class="text-xl font-bold text-green-600">--</p>
        </div>
        <div class="bg-yellow-50 p-4 rounded-lg text-center">
          <p class="text-sm font-medium text-gray-700">–ü—Ä–∏–±—É—Ç–æ–∫ (–≥—Ä–Ω)</p>
          <p id="profit" class="text-xl font-bold text-yellow-600">--</p>
        </div>
      </div>
      <p id="taxInfo" class="text-sm text-gray-600 mb-6 text-center hidden">–ó –ø—Ä–∏–±—É—Ç–∫—É —Å–ø–ª–∞—á—É—é—Ç—å –ø–æ–¥–∞—Ç–∫–∏: –ü–î–§–û = 18% —Ç–∞ –≤—ñ–π—Å—å–∫–æ–≤–∏–π –∑–±—ñ—Ä = 5%</p>

      <!-- Charts -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
          <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-4 text-center">–ü–æ–º—ñ—Å—è—á–Ω–µ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (–∫–í—Ç¬∑–≥–æ–¥)</h3>
          <canvas id="barChart" class="w-full"></canvas>
          <p class="text-sm text-gray-600 mt-3 text-center">–°—Ç–æ–≤–ø—á–∞—Å—Ç–∞ –¥—ñ–∞–≥—Ä–∞–º–∞ –ø–æ—Ä—ñ–≤–Ω—é—î –ø–æ–º—ñ—Å—è—á–Ω—É –≥–µ–Ω–µ—Ä–∞—Ü—ñ—é —Ç–∞ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è.</p>
        </div>
        <div class="flex flex-col items-center">
          <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-4 text-center">–†–æ–∑–ø–æ–¥—ñ–ª –µ–Ω–µ—Ä–≥—ñ—ó (%)</h3>
          <canvas id="pieChart" class="w-full"></canvas>
          <p class="text-sm text-gray-600 mt-3 text-center">–ö—Ä—É–≥–æ–≤–∞ –¥—ñ–∞–≥—Ä–∞–º–∞ –ø–æ–∫–∞–∑—É—î —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–æ–≥–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞—á—ñ –≤ –º–µ—Ä–µ–∂—É.</p>
        </div>
      </div>

      <div class="mt-6 text-center">
        <p class="text-sm font-medium text-gray-700">–°–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–æ–≥–æ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è</p>
        <p id="consumptionRatio" class="text-xl font-bold text-blue-600">--</p>
      </div>
      <p class="text-sm text-gray-600 mt-4 text-center">–¶–µ —î –ø—Ä–∏–±–ª–∏–∑–Ω—ñ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–æ–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è, –≤—Å–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –∫—É—Ç—ñ–≤ –Ω–∞—Ö–∏–ª—É, —Ö–º–∞—Ä–Ω–æ—Å—Ç—ñ —Ç–∞ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è —ñ —Ç.–¥. üåû</p>
    </div>

    <!-- Contact Modal -->
    <div id="contactModal" class="modal items-center justify-center">
      <div class="modal-content bg-white p-6 md:p-8 rounded-xl shadow-lg border border-gray-100 max-w-md w-full">
        <h2 class="text-xl md:text-2xl font-semibold text-gray-800 mb-6 text-center">–ö–æ–Ω—Ç–∞–∫—Ç–Ω—ñ –¥–∞–Ω—ñ üìû</h2>
        <form id="contactForm" novalidate>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700">–Ü–º‚Äô—è</label>
              <input type="text" name="entry.797046125" id="firstName" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="–í–≤–µ–¥—ñ—Ç—å —ñ–º‚Äô—è" required>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω—É</label>
              <input type="tel" name="entry.550678584" id="phone" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="–ù–∞–ø—Ä., +380123456789" required>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">–ß–∏ –≤–∏ —î –∫–ª—ñ—î–Ω—Ç–æ–º –∫–æ–º–ø–∞–Ω—ñ—ó?</label>
              <select name="entry.704844127" id="isClient" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white" required>
                <option value="" disabled selected>–í–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é</option>
                <option value="–¢–∞–∫">–¢–∞–∫</option>
                <option value="–ù—ñ">–ù—ñ</option>
              </select>
            </div>
            <div>
              <label class="block text-sm font-medium text-gray-700">–ß–∏ –∑ –≤–∞–º–∏ –º–æ–∂–Ω–∞ –∑–≤‚Äô—è–∑–∞—Ç–∏—Å—å?</label>
              <select name="entry.580596646" id="contactRequest" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white" required>
                <option value="" disabled selected>–í–∏–±–µ—Ä—ñ—Ç—å –æ–ø—Ü—ñ—é</option>
                <option value="–¢–∞–∫">–¢–∞–∫</option>
                <option value="–ù—ñ">–ù—ñ</option>
              </select>
            </div>
          </div>
          <button type="button" id="submitAll" class="mt-6 w-full bg-blue-500 text-white p-4 rounded-lg hover:bg-blue-600 transition-colors text-lg font-semibold flex items-center justify-center">
            –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ <span class="ml-2">‚úÖ</span>
          </button>
          <button type="button" id="closeModal" class="mt-4 w-full bg-gray-200 text-gray-700 p-4 rounded-lg hover:bg-gray-300 transition-colors text-lg font-semibold">–ó–∞–∫—Ä–∏—Ç–∏</button>
        </form>
      </div>
    </div>

    <!-- Confirmation Message -->
    
    
    <div id="confirmation" class="hidden mt-6 p-6 bg-green-100 text-green-800 rounded-lg shadow-lg text-center whitespace-nowrap overflow-auto">
      ‚úÖ –î—è–∫—É—î–º–æ, <span id="confName" class="font-bold"></span>! –ú–∏ –∑–≤‚Äô—è–∂–µ–º–æ—Å—è –∑ –≤–∞–º–∏ –∑–∞ –Ω–æ–º–µ—Ä–æ–º <span id="confPhone" class="font-bold"></span> ‚òéÔ∏è
    </div>
    
    

    <script>
      // Monthly generation per 1 kW (kWh)
      const monthlyGenerationPerKW = [41.74, 53.67, 95.43, 143.36, 145.98, 157.96, 157.96, 154.97, 130.85, 65.61, 47.63, 35.83];

      // Initialize Charts
      const barCtx = document.getElementById('barChart').getContext('2d');
      const barChart = new Chart(barCtx, {
        type: 'bar',
        data: {
          labels: ['–°—ñ—á', '–õ—é—Ç', '–ë–µ—Ä', '–ö–≤—ñ', '–¢—Ä–∞', '–ß–µ—Ä', '–õ–∏–ø', '–°–µ—Ä', '–í–µ—Ä', '–ñ–æ–≤', '–õ–∏—Å', '–ì—Ä—É'],
          datasets: [
            {
              label: '–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è (–∫–í—Ç¬∑–≥–æ–¥)',
              data: Array(12).fill(0),
              backgroundColor: '#2ecc71',
              borderColor: '#27ae60',
              borderWidth: 1
            },
            {
              label: '–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è (–∫–í—Ç¬∑–≥–æ–¥)',
              data: Array(12).fill(0),
              backgroundColor: '#e74c3c',
              borderColor: '#c0392b',
              borderWidth: 1
            }
          ]
        },
        options: {
          scales: {
            y: { beginAtZero: true, title: { display: true, text: '–∫–í—Ç¬∑–≥–æ–¥', font: { size: 14 } } },
            x: { title: { display: true, text: '–ú—ñ—Å—è—Ü—å', font: { size: 14 } } }
          },
          plugins: { legend: { position: 'top', labels: { font: { size: 12 } } } },
          animation: { duration: 1000 }
        }
      });

      const pieCtx = document.getElementById('pieChart').getContext('2d');
      const pieChart = new Chart(pieCtx, {
        type: 'pie',
        data: {
          labels: ['–í–ª–∞—Å–Ω–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è', '–í–∏–¥–∞—á–∞ –≤ –º–µ—Ä–µ–∂—É'],
          datasets: [{
            data: [0, 0],
            backgroundColor: ['#1e90ff', '#2ecc71'],
            borderColor: ['#1e90ff', '#27ae60'],
            borderWidth: 1
          }]
        },
        options: {
          plugins: {
            legend: { position: 'bottom', labels: { font: { size: 12 } } },
            tooltip: {
              callbacks: {
                label: (ctx) => {
                  const label = ctx.label;
                  const value = ctx.raw;
                  const total = ctx.dataset.data.reduce((sum, val) => sum + val, 0);
                  const kWh = (value / 100) * total * (ctx.chart.annualGeneration || 0);
                  return `${label}: ${value.toFixed(2)}% (${kWh.toFixed(2)} –∫–í—Ç¬∑–≥–æ–¥)`;
                }
              }
            }
          },
          animation: { duration: 1000 },
          hoverOffset: 20
        }
      });

      // Open Contact Modal on Calculate Button Click
      document.getElementById('openContact').addEventListener('click', (e) => {
        e.preventDefault();

        // Collect Form Data
        const objectType = document.getElementById('objectType').value;
        const stationType = document.getElementById('stationType').value;
        const region = document.getElementById('region').value;
        const powerCapacity = parseFloat(document.getElementById('powerCapacity').value);
        const greenTariff = document.getElementById('greenTariff').value === '–¢–∞–∫';

        // Monthly Consumption (non-mandatory)
        const months = Array.from({length: 12}, (_, i) => parseFloat(document.getElementById(`month${i+1}`).value) || 0);
        const annualConsumption = months.reduce((sum, val) => sum + val, 0);

        // Validation for fields
        
const form = document.getElementById('solarForm');
if (!form.checkValidity()) {
  form.reportValidity(); // –ø–æ–∫–∞–∑—É—î –≤–±—É–¥–æ–≤–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Ç–∏–ø—É "–ó–∞–ø–æ–≤–Ω—ñ—Ç—å —Ü–µ –ø–æ–ª–µ"
  return;
}


        // Calculations
        const monthlyGeneration = monthlyGenerationPerKW.map(val => val * powerCapacity);
        const annualGeneration = monthlyGeneration.reduce((sum, val) => sum + val, 0);
        const electricityRate = objectType === '–ü—Ä–∏–≤–∞—Ç–Ω–∏–π' ? 4.32 : 8.96;
        const selfConsumption = Math.min(annualGeneration, annualConsumption);
        const excessGeneration = Math.max(0, annualGeneration - selfConsumption);
        const savings = selfConsumption * electricityRate;
        let profit = 0;
        if (excessGeneration > 0 && greenTariff) {
          const euroRate = 45; // Assumed EUR to UAH rate
          profit = ((excessGeneration * 0.16) * euroRate) * (1 - 0.23); // Deduct 23% taxes
        }
        const consumptionRatio = annualGeneration > 0 ? (selfConsumption / annualGeneration * 100).toFixed(0) : 0;
        const gridFeedPercentage = annualGeneration > 0 ? (excessGeneration / annualGeneration * 100).toFixed(2) : 0;
        const selfConsumptionPercentage = annualGeneration > 0 ? (selfConsumption / annualGeneration * 100).toFixed(2) : 0;

        // Update Results
        document.getElementById('annualGeneration').textContent = annualGeneration.toFixed(2);
        document.getElementById('savings').textContent = savings.toFixed(2);
        document.getElementById('profit').textContent = profit.toFixed(2);
        document.getElementById('consumptionRatio').textContent = consumptionRatio + '%';
        document.getElementById('taxInfo').classList.toggle('hidden', profit === 0);
        document.getElementById('results').classList.remove('hidden');

        // Store annualGeneration for pie chart tooltip
        pieChart.annualGeneration = annualGeneration;

        // Update Bar Chart
        barChart.data.datasets[0].data = monthlyGeneration;
        barChart.data.datasets[1].data = months;
        barChart.update();

        // Update Pie Chart
        pieChart.data.datasets[0].data = [selfConsumptionPercentage, gridFeedPercentage];
        pieChart.update();

        // Show Contact Modal
        document.getElementById('contactModal').style.display = 'flex';
      });

      // Submit All Data on Send Button Click
      document.getElementById('submitAll').addEventListener('click', (e) => {
        e.preventDefault();

        // Collect Contact Form Data
        const firstName = document.getElementById('firstName').value;
        const phone = document.getElementById('phone').value;
        const isClient = document.getElementById('isClient').value;
        const contactRequest = document.getElementById('contactRequest').value;

        // Validation for contact form
        if (!firstName || !phone || !isClient || !contactRequest) {
          alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ—ó —Ñ–æ—Ä–º–∏.');
          return;
        }

        // Collect All Form Data
        const solarFormData = new FormData(document.getElementById('solarForm'));
        const contactFormData = new FormData(document.getElementById('contactForm'));

        // Combine data from both forms
        const combinedFormData = new FormData();
        for (let [key, value] of solarFormData.entries()) {
          combinedFormData.append(key, value);
        }
        for (let [key, value] of contactFormData.entries()) {
          combinedFormData.append(key, value);
        }

        // Send Data to Google Forms
        fetch('https://docs.google.com/forms/u/1/d/e/1FAIpQLSd0UfQ7yNyOaT8SavTybxksGA9aYUGM8vyg4cw4V9fODwh8Mw/formResponse', {
          method: 'POST',
          body: combinedFormData,
          mode: 'no-cors'
        }).then(() => {
          
    document.getElementById('confName').textContent = firstName;
    document.getElementById('confPhone').textContent = phone;
    document.getElementById('confirmation').classList.remove('hidden');
    
          document.getElementById('contactModal').style.display = 'none';
          document.getElementById('solarForm').reset();
          document.getElementById('contactForm').reset();
          
        }).catch(error => {
          console.error('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—ñ:', error);
          alert('–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—ñ –¥–∞–Ω–∏—Ö. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑.');
        });
      });

      // Close Modal
      document.getElementById('closeModal').addEventListener('click', () => {
        document.getElementById('contactModal').style.display = 'none';
      });
    </script>
</body>
</html>